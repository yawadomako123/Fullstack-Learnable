# рдПрдХ рд╡реНрдпрдВрдЬрди рд╕рд┐рдлрд╛рд░рд┐рд╢ рд╡реЗрдм рдРрдк рдмрдирд╛рдПрдВ

рдЗрд╕ рдкрд╛рда рдореЗрдВ, рдЖрдк рдХреБрдЫ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╡рд░реНрдЧреАрдХрд░рдг рдореЙрдбрд▓ рдмрдирд╛рдПрдВрдЧреЗ, рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдкрдиреЗ рдкрд┐рдЫрд▓реЗ рдкрд╛рдареЛрдВ рдореЗрдВ рд╕реАрдЦрд╛ рд╣реИ рдФрд░ рдЗрд╕ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд╕реНрд╡рд╛рджрд┐рд╖реНрдЯ рд╡реНрдпрдВрдЬрди рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рд╕рд╛рдеред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдЖрдк рдПрдХ рдЫреЛрдЯрд╛ рд╡реЗрдм рдРрдк рдмрдирд╛рдПрдВрдЧреЗ рдЬреЛ рдПрдХ рд╕рд╣реЗрдЬреЗ рдЧрдП рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛, Onnx рдХреЗ рд╡реЗрдм рд░рдирдЯрд╛рдЗрдо рдХрд╛ рд▓рд╛рдн рдЙрдард╛рддреЗ рд╣реБрдПред

рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рдХрд╛ рд╕рдмрд╕реЗ рдЙрдкрдпреЛрдЧреА рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдЙрдкрдпреЛрдЧ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдкреНрд░рдгрд╛рд▓реА рдмрдирд╛рдирд╛ рд╣реИ, рдФрд░ рдЖрдк рдЖрдЬ рдЙрд╕ рджрд┐рд╢рд╛ рдореЗрдВ рдкрд╣рд▓рд╛ рдХрджрдо рдЙрдард╛ рд╕рдХрддреЗ рд╣реИрдВ!

[![рдЗрд╕ рд╡реЗрдм рдРрдк рдХреЛ рдкреНрд░рд╕реНрддреБрдд рдХрд░рддреЗ рд╣реБрдП](https://img.youtube.com/vi/17wdM9AHMfg/0.jpg)](https://youtu.be/17wdM9AHMfg "Applied ML")

> ЁЯОе рдКрдкрд░ рдХреА рдЫрд╡рд┐ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдПрдХ рд╡реАрдбрд┐рдпреЛ рдХреЗ рд▓рд┐рдП: Jen Looper рд╡рд░реНрдЧреАрдХреГрдд рд╡реНрдпрдВрдЬрди рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╡реЗрдм рдРрдк рдмрдирд╛рддреА рд╣реИрдВ

## [рдкрд╛рда рдкреВрд░реНрд╡ рдХреНрд╡рд┐рдЬрд╝](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/25/)

рдЗрд╕ рдкрд╛рда рдореЗрдВ рдЖрдк рд╕реАрдЦреЗрдВрдЧреЗ:

- рдПрдХ рдореЙрдбрд▓ рдХреИрд╕реЗ рдмрдирд╛рдПрдВ рдФрд░ рдЗрд╕реЗ рдПрдХ Onnx рдореЙрдбрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВ
- Netron рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореЙрдбрд▓ рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХреИрд╕реЗ рдХрд░реЗрдВ
- рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХреЛ рдПрдХ рд╡реЗрдм рдРрдк рдореЗрдВ рдЕрдиреБрдорд╛рди рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ

## рдЕрдкрдирд╛ рдореЙрдбрд▓ рдмрдирд╛рдПрдВ

рд▓рд╛рдЧреВ рдПрдордПрд▓ рд╕рд┐рд╕реНрдЯрдо рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдЗрди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдкрдХреЗ рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред рдЖрдк Onnx рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреЗ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдФрд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдкрдбрд╝рдиреЗ рдкрд░ рдЙрдиреНрд╣реЗрдВ рдСрдлрд╝рд▓рд╛рдЗрди рд╕рдВрджрд░реНрдн рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)ред

рдПрдХ [рдкрд┐рдЫрд▓реЗ рдкрд╛рда](../../3-Web-App/1-Web-App/README.md) рдореЗрдВ, рдЖрдкрдиреЗ рдпреВрдПрдлрдУ рджреЗрдЦреЗ рдЬрд╛рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рдкреНрд░рддрд┐рдЧрдорди рдореЙрдбрд▓ рдмрдирд╛рдпрд╛, рдЗрд╕реЗ "рдкрд┐рдХрд▓реНрдб" рдХрд┐рдпрд╛, рдФрд░ рдЗрд╕реЗ рдПрдХ Flask рдРрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ред рдЬрдмрдХрд┐ рдпрд╣ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реИ, рдпрд╣ рдПрдХ рдлреБрд▓-рд╕реНрдЯреИрдХ рдкрд╛рдпрдерди рдРрдк рд╣реИ, рдФрд░ рдЖрдкрдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдореЗрдВ рдПрдХ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕ рдкрд╛рда рдореЗрдВ, рдЖрдк рдЕрдиреБрдорд╛рди рдХреЗ рд▓рд┐рдП рдПрдХ рдмреБрдирд┐рдпрд╛рджреА рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ-рдЖрдзрд╛рд░рд┐рдд рд╕рд┐рд╕реНрдЯрдо рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЛ рдПрдХ рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЗрд╕реЗ Onnx рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

## рдЕрднреНрдпрд╛рд╕ - рд╡рд░реНрдЧреАрдХрд░рдг рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░реЗрдВ

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЙрд╕ рд╕рд╛рдл рдХрд┐рдП рдЧрдП рд╡реНрдпрдВрдЬрди рдбреЗрдЯрд╛рд╕реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╡рд░реНрдЧреАрдХрд░рдг рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░реЗрдВ рдЬрд┐рд╕реЗ рд╣рдордиреЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдерд╛ред

1. рдЙрдкрдпреЛрдЧреА рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ рдЖрдпрд╛рдд рдХрд░рдХреЗ рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВ:

    ```python
    !pip install skl2onnx
    import pandas as pd 
    ```

    рдЖрдкрдХреЛ рдЕрдкрдиреЗ Scikit-learn рдореЙрдбрд▓ рдХреЛ Onnx рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдмрджрд▓рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП '[skl2onnx](https://onnx.ai/sklearn-onnx/)' рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

1. рдлрд┐рд░, рдЕрдкрдиреЗ рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдЙрд╕реА рддрд░рд╣ рдХрд╛рдо рдХрд░реЗрдВ рдЬреИрд╕реЗ рдЖрдкрдиреЗ рдкрд┐рдЫрд▓реЗ рдкрд╛рдареЛрдВ рдореЗрдВ рдХрд┐рдпрд╛ рдерд╛, `read_csv()` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ CSV рдлрд╝рд╛рдЗрд▓ рдкрдврд╝рдХрд░:

    ```python
    data = pd.read_csv('../data/cleaned_cuisines.csv')
    data.head()
    ```

1. рдкрд╣рд▓реЗ рджреЛ рдЕрдирд╛рд╡рд╢реНрдпрдХ рд╕реНрддрдВрднреЛрдВ рдХреЛ рд╣рдЯрд╛ рджреЗрдВ рдФрд░ рд╢реЗрд╖ рдбреЗрдЯрд╛ рдХреЛ 'X' рдХреЗ рд░реВрдк рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВ:

    ```python
    X = data.iloc[:,2:]
    X.head()
    ```

1. рд▓реЗрдмрд▓ рдХреЛ 'y' рдХреЗ рд░реВрдк рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВ:

    ```python
    y = data[['cuisine']]
    y.head()
    
    ```

### рдкреНрд░рд╢рд┐рдХреНрд╖рдг рджрд┐рдирдЪрд░реНрдпрд╛ рд╢реБрд░реВ рдХрд░реЗрдВ

рд╣рдо 'SVC' рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдЬрд┐рд╕рдореЗрдВ рдЕрдЪреНрдЫреА рд╕рдЯреАрдХрддрд╛ рд╣реИред

1. Scikit-learn рд╕реЗ рдЙрдкрдпреБрдХреНрдд рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ рдЖрдпрд╛рдд рдХрд░реЗрдВ:

    ```python
    from sklearn.model_selection import train_test_split
    from sklearn.svm import SVC
    from sklearn.model_selection import cross_val_score
    from sklearn.metrics import accuracy_score,precision_score,confusion_matrix,classification_report
    ```

1. рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рдкрд░реАрдХреНрд╖рдг рд╕реЗрдЯ рдЕрд▓рдЧ рдХрд░реЗрдВ:

    ```python
    X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.3)
    ```

1. рдкрд┐рдЫрд▓реЗ рдкрд╛рда рдореЗрдВ рдЬреИрд╕рд╛ рдЖрдкрдиреЗ рдХрд┐рдпрд╛ рдерд╛, рдПрдХ SVC рд╡рд░реНрдЧреАрдХрд░рдг рдореЙрдбрд▓ рдмрдирд╛рдПрдВ:

    ```python
    model = SVC(kernel='linear', C=10, probability=True,random_state=0)
    model.fit(X_train,y_train.values.ravel())
    ```

1. рдЕрдм, рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░реЗрдВ, `predict()` рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВ:

    ```python
    y_pred = model.predict(X_test)
    ```

1. рдореЙрдбрд▓ рдХреА рдЧреБрдгрд╡рддреНрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд░реНрдЧреАрдХрд░рдг рд░рд┐рдкреЛрд░реНрдЯ рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВ:

    ```python
    print(classification_report(y_test,y_pred))
    ```

    рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ рдкрд╣рд▓реЗ рджреЗрдЦрд╛ рдерд╛, рд╕рдЯреАрдХрддрд╛ рдЕрдЪреНрдЫреА рд╣реИ:

    ```output
                    precision    recall  f1-score   support
    
         chinese       0.72      0.69      0.70       257
          indian       0.91      0.87      0.89       243
        japanese       0.79      0.77      0.78       239
          korean       0.83      0.79      0.81       236
            thai       0.72      0.84      0.78       224
    
        accuracy                           0.79      1199
       macro avg       0.79      0.79      0.79      1199
    weighted avg       0.79      0.79      0.79      1199
    ```

### рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХреЛ Onnx рдореЗрдВ рдмрджрд▓реЗрдВ

рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЙрдЪрд┐рдд рдЯреЗрдВрд╕рд░ рд╕рдВрдЦреНрдпрд╛ рдХреЗ рд╕рд╛рде рд░реВрдкрд╛рдВрддрд░рдг рдХрд░реЗрдВред рдЗрд╕ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ 380 рдЕрд╡рдпрд╡ рд╕реВрдЪреАрдмрджреНрдз рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ `FloatTensorType` рдореЗрдВ рдЙрд╕ рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдиреЛрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛:

1. 380 рдХреА рдЯреЗрдВрд╕рд░ рд╕рдВрдЦреНрдпрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░реЗрдВред

    ```python
    from skl2onnx import convert_sklearn
    from skl2onnx.common.data_types import FloatTensorType
    
    initial_type = [('float_input', FloatTensorType([None, 380]))]
    options = {id(model): {'nocl': True, 'zipmap': False}}
    ```

1. onx рдмрдирд╛рдПрдВ рдФрд░ рдЗрд╕реЗ **model.onnx** рдХреЗ рд░реВрдк рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВ:

    ```python
    onx = convert_sklearn(model, initial_types=initial_type, options=options)
    with open("./model.onnx", "wb") as f:
        f.write(onx.SerializeToString())
    ```

    > рдиреЛрдЯ, рдЖрдк рдЕрдкрдиреЗ рд░реВрдкрд╛рдВрддрд░рдг рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ [рд╡рд┐рдХрд▓реНрдк](https://onnx.ai/sklearn-onnx/parameterized.html) рдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдордиреЗ 'nocl' рдХреЛ True рдФрд░ 'zipmap' рдХреЛ False рдкрд╛рд╕ рдХрд┐рдпрд╛ред рдЪреВрдВрдХрд┐ рдпрд╣ рдПрдХ рд╡рд░реНрдЧреАрдХрд░рдг рдореЙрдбрд▓ рд╣реИ, рдЖрдкрдХреЗ рдкрд╛рд╕ ZipMap рдХреЛ рд╣рдЯрд╛рдиреЗ рдХрд╛ рд╡рд┐рдХрд▓реНрдк рд╣реИ рдЬреЛ рд╢рдмреНрджрдХреЛрд╢реЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ (рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ)ред `nocl` refers to class information being included in the model. Reduce your model's size by setting `nocl` to 'True'. 

Running the entire notebook will now build an Onnx model and save it to this folder.

## View your model

Onnx models are not very visible in Visual Studio code, but there's a very good free software that many researchers use to visualize the model to ensure that it is properly built. Download [Netron](https://github.com/lutzroeder/Netron) and  open your model.onnx file. You can see your simple model visualized, with its 380 inputs and classifier listed:

![Netron visual](../../../../translated_images/netron.a05f39410211915e0f95e2c0e8b88f41e7d13d725faf660188f3802ba5c9e831.hi.png)

Netron is a helpful tool to view your models.

Now you are ready to use this neat model in a web app. Let's build an app that will come in handy when you look in your refrigerator and try to figure out which combination of your leftover ingredients you can use to cook a given cuisine, as determined by your model.

## Build a recommender web application

You can use your model directly in a web app. This architecture also allows you to run it locally and even offline if needed. Start by creating an `index.html` file in the same folder where you stored your `model.onnx` рдлрд╝рд╛рдЗрд▓ред

1. рдЗрд╕ рдлрд╝рд╛рдЗрд▓ _index.html_ рдореЗрдВ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдорд╛рд░реНрдХрдЕрдк рдЬреЛрдбрд╝реЗрдВ:

    ```html
    <!DOCTYPE html>
    <html>
        <header>
            <title>Cuisine Matcher</title>
        </header>
        <body>
            ...
        </body>
    </html>
    ```

1. рдЕрдм, `body` рдЯреИрдЧ рдХреЗ рднреАрддрд░ рдХрд╛рдо рдХрд░рддреЗ рд╣реБрдП, рдХреБрдЫ рдЕрд╡рдпрд╡реЛрдВ рдХреЛ рджрд░реНрд╢рд╛рдиреЗ рд╡рд╛рд▓реЗ рдЪреЗрдХрдмреЙрдХреНрд╕ рдХреА рдПрдХ рд╕реВрдЪреА рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдереЛрдбрд╝рд╛ рдорд╛рд░реНрдХрдЕрдк рдЬреЛрдбрд╝реЗрдВ:

    ```html
    <h1>Check your refrigerator. What can you create?</h1>
            <div id="wrapper">
                <div class="boxCont">
                    <input type="checkbox" value="4" class="checkbox">
                    <label>apple</label>
                </div>
            
                <div class="boxCont">
                    <input type="checkbox" value="247" class="checkbox">
                    <label>pear</label>
                </div>
            
                <div class="boxCont">
                    <input type="checkbox" value="77" class="checkbox">
                    <label>cherry</label>
                </div>
    
                <div class="boxCont">
                    <input type="checkbox" value="126" class="checkbox">
                    <label>fenugreek</label>
                </div>
    
                <div class="boxCont">
                    <input type="checkbox" value="302" class="checkbox">
                    <label>sake</label>
                </div>
    
                <div class="boxCont">
                    <input type="checkbox" value="327" class="checkbox">
                    <label>soy sauce</label>
                </div>
    
                <div class="boxCont">
                    <input type="checkbox" value="112" class="checkbox">
                    <label>cumin</label>
                </div>
            </div>
            <div style="padding-top:10px">
                <button onClick="startInference()">What kind of cuisine can you make?</button>
            </div> 
    ```

    рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдЪреЗрдХрдмреЙрдХреНрд╕ рдХреЛ рдПрдХ рдорд╛рди рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ рдЙрд╕ рдЗрдВрдбреЗрдХреНрд╕ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдЕрд╡рдпрд╡ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдкрд╛рдП рдЬрд╛рддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрд╕ рд╡рд░реНрдгрдорд╛рд▓рд╛ рд╕реВрдЪреА рдореЗрдВ, Apple рдкрд╛рдВрдЪрд╡реЗрдВ рд╕реНрддрдВрдн рдкрд░ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕рдХрд╛ рдорд╛рди '4' рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╣рдо 0 рд╕реЗ рдЧрд┐рдирддреА рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВред рдЖрдк [рдЕрд╡рдпрд╡ рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ](../../../../4-Classification/data/ingredient_indexes.csv) рдХреЛ рдкрд░рд╛рдорд░реНрд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдХрд┐рд╕реА рджрд┐рдП рдЧрдП рдЕрд╡рдпрд╡ рдХрд╛ рдЗрдВрдбреЗрдХреНрд╕ рдЦреЛрдЬрд╛ рдЬрд╛ рд╕рдХреЗред

    _index.html_ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЕрдкрдиреЗ рдХрд╛рдо рдХреЛ рдЬрд╛рд░реА рд░рдЦрддреЗ рд╣реБрдП, рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдмреНрд▓реЙрдХ рдЬреЛрдбрд╝реЗрдВ рдЬрд╣рд╛рдВ рдЕрдВрддрд┐рдо рд╕рдорд╛рдкрди `</div>` рдХреЗ рдмрд╛рдж рдореЙрдбрд▓ рдХреЛ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

1. рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, [Onnx Runtime](https://www.onnxruntime.ai/) рдХреЛ рдЖрдпрд╛рдд рдХрд░реЗрдВ:

    ```html
    <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web@1.9.0/dist/ort.min.js"></script> 
    ```

    > Onnx Runtime рдХрд╛ рдЙрдкрдпреЛрдЧ рдЖрдкрдХреЗ Onnx рдореЙрдбрд▓реЛрдВ рдХреЛ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдкреНрд▓реЗрдЯрдлрд╛рд░реНрдореЛрдВ рдХреА рдПрдХ рд╡рд┐рд╕реНрддреГрдд рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЗрдВ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЕрдиреБрдХреВрд▓рди рдФрд░ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рдПрдкреАрдЖрдИ рд╢рд╛рдорд┐рд▓ рд╣реИред

1. рдПрдХ рдмрд╛рд░ Runtime рд╕реЗрдЯ рд╣реЛ рдЬрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдЖрдк рдЗрд╕реЗ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

    ```html
    <script>
        const ingredients = Array(380).fill(0);
        
        const checks = [...document.querySelectorAll('.checkbox')];
        
        checks.forEach(check => {
            check.addEventListener('change', function() {
                // toggle the state of the ingredient
                // based on the checkbox's value (1 or 0)
                ingredients[check.value] = check.checked ? 1 : 0;
            });
        });

        function testCheckboxes() {
            // validate if at least one checkbox is checked
            return checks.some(check => check.checked);
        }

        async function startInference() {

            let atLeastOneChecked = testCheckboxes()

            if (!atLeastOneChecked) {
                alert('Please select at least one ingredient.');
                return;
            }
            try {
                // create a new session and load the model.
                
                const session = await ort.InferenceSession.create('./model.onnx');

                const input = new ort.Tensor(new Float32Array(ingredients), [1, 380]);
                const feeds = { float_input: input };

                // feed inputs and run
                const results = await session.run(feeds);

                // read from results
                alert('You can enjoy ' + results.label.data[0] + ' cuisine today!')

            } catch (e) {
                console.log(`failed to inference ONNX model`);
                console.error(e);
            }
        }
               
    </script>
    ```

рдЗрд╕ рдХреЛрдб рдореЗрдВ, рдХрдИ рдЪреАрдЬреЗрдВ рд╣реЛ рд░рд╣реА рд╣реИрдВ:

1. рдЖрдкрдиреЗ 380 рд╕рдВрднрд╛рд╡рд┐рдд рдорд╛рдиреЛрдВ (1 рдпрд╛ 0) рдХрд╛ рдПрдХ рд╕рд░рдгреА рдмрдирд╛рдпрд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдореЙрдбрд▓ рдХреЛ рдЕрдиреБрдорд╛рди рдХреЗ рд▓рд┐рдП рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛, рдЗрд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреЛрдИ рдЕрд╡рдпрд╡ рдЪреЗрдХрдмреЙрдХреНрд╕ рдЪреЗрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред
2. рдЖрдкрдиреЗ рдЪреЗрдХрдмреЙрдХреНрд╕ рдХреА рдПрдХ рд╕рд░рдгреА рдмрдирд╛рдИ рдФрд░ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдХрд┐ рдХреНрдпрд╛ рд╡реЗ `init` function that is called when the application starts. When a checkbox is checked, the `ingredients` array is altered to reflect the chosen ingredient.
3. You created a `testCheckboxes` function that checks whether any checkbox was checked.
4. You use `startInference` function when the button is pressed and, if any checkbox is checked, you start inference.
5. The inference routine includes:
   1. Setting up an asynchronous load of the model
   2. Creating a Tensor structure to send to the model
   3. Creating 'feeds' that reflects the `float_input` input that you created when training your model (you can use Netron to verify that name)
   4. Sending these 'feeds' to the model and waiting for a response

## Test your application

Open a terminal session in Visual Studio Code in the folder where your index.html file resides. Ensure that you have [http-server](https://www.npmjs.com/package/http-server) installed globally, and type `http-server` рдкрд░ рд╕рдВрдХреЗрдд рдкрд░ рдЪреЗрдХ рдХрд┐рдП рдЧрдП рдереЗред рдПрдХ рд▓реЛрдХрд▓рд╣реЛрд╕реНрдЯ рдЦреБрд▓ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЖрдк рдЕрдкрдиреЗ рд╡реЗрдм рдРрдк рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред рд╡рд┐рднрд┐рдиреНрди рдЕрд╡рдпрд╡реЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХреМрди рд╕рд╛ рд╡реНрдпрдВрдЬрди рдЕрдиреБрд╢рдВрд╕рд┐рдд рд╣реИ, рдЗрд╕рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:

![рдЕрд╡рдпрд╡ рд╡реЗрдм рдРрдк](../../../../translated_images/web-app.4c76450cabe20036f8ec6d5e05ccc0c1c064f0d8f2fe3304d3bcc0198f7dc139.hi.png)

рдмрдзрд╛рдИ рд╣реЛ, рдЖрдкрдиреЗ рдХреБрдЫ рдлрд╝реАрд▓реНрдб рдХреЗ рд╕рд╛рде рдПрдХ 'рд╕рд┐рдлрд╛рд░рд┐рд╢' рд╡реЗрдм рдРрдк рдмрдирд╛рдпрд╛ рд╣реИред рдЗрд╕ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рд╕рдордп рдирд┐рдХрд╛рд▓реЗрдВ!
## ЁЯЪАрдЪреБрдиреМрддреА

рдЖрдкрдХрд╛ рд╡реЗрдм рдРрдк рдмрд╣реБрдд рдиреНрдпреВрдирддрдо рд╣реИ, рдЗрд╕рд▓рд┐рдП [ingredient_indexes](../../../../4-Classification/data/ingredient_indexes.csv) рдбреЗрдЯрд╛ рд╕реЗ рдЕрд╡рдпрд╡реЛрдВ рдФрд░ рдЙрдирдХреЗ рдЗрдВрдбреЗрдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рдмрдирд╛рдирд╛ рдЬрд╛рд░реА рд░рдЦреЗрдВред рдХреМрди рд╕реЗ рд╕реНрд╡рд╛рдж рд╕рдВрдпреЛрдЬрди рдПрдХ рджрд┐рдП рдЧрдП рд░рд╛рд╖реНрдЯреНрд░реАрдп рд╡реНрдпрдВрдЬрди рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ?

## [рдкрд╛рда рдХреЗ рдмрд╛рдж рдХреНрд╡рд┐рдЬрд╝](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/26/)

## рд╕рдореАрдХреНрд╖рд╛ рдФрд░ рд╕реНрд╡-рдЕрдзреНрдпрдпрди

рдЬрдмрдХрд┐ рдЗрд╕ рдкрд╛рда рдиреЗ рдЦрд╛рджреНрдп рдЕрд╡рдпрд╡реЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдкреНрд░рдгрд╛рд▓реА рдмрдирд╛рдиреЗ рдХреА рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХреЛ рдЫреБрдЖ, рдПрдордПрд▓ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХрд╛ рдпрд╣ рдХреНрд╖реЗрддреНрд░ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рдмрд╣реБрдд рд╕рдореГрджреНрдз рд╣реИред рдкрдврд╝реЗрдВ рдХрд┐ рдЗрди рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдХреЛ рдХреИрд╕реЗ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:

- https://www.sciencedirect.com/topics/computer-science/recommendation-engine
- https://www.technologyreview.com/2014/08/25/171547/the-ultimate-challenge-for-recommendation-engines/
- https://www.technologyreview.com/2015/03/23/168831/everything-is-a-recommendation/

## рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ 

[рдПрдХ рдирдИ рд╕рд┐рдлрд╛рд░рд┐рд╢рдХрд░реНрддрд╛ рдмрдирд╛рдПрдВ](assignment.md)

**рдЕрд╕реНрд╡реАрдХрд░рдг**:
рдпрд╣ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдорд╢реАрди-рдЖрдзрд╛рд░рд┐рдд рдПрдЖрдИ рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд╡рд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЬрдмрдХрд┐ рд╣рдо рд╕рдЯреАрдХрддрд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ, рдХреГрдкрдпрд╛ рдЕрд╡рдЧрдд рд░рд╣реЗрдВ рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рдж рдореЗрдВ рддреНрд░реБрдЯрд┐рдпрд╛рдВ рдпрд╛ рдЕрд╢реБрджреНрдзрд┐рдпрд╛рдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдЕрдкрдиреА рдореВрд▓ рднрд╛рд╖рд╛ рдореЗрдВ рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╕реНрд░реЛрдд рдорд╛рдирд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, рдкреЗрд╢реЗрд╡рд░ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред рдЗрд╕ рдЕрдиреБрд╡рд╛рдж рдХреЗ рдЙрдкрдпреЛрдЧ рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рд╕реА рднреА рдЧрд▓рддрдлрд╣рдореА рдпрд╛ рдЧрд▓рдд рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЗ рд▓рд┐рдП рд╣рдо рдЙрддреНрддрд░рджрд╛рдпреА рдирд╣реАрдВ рд╣реИрдВред