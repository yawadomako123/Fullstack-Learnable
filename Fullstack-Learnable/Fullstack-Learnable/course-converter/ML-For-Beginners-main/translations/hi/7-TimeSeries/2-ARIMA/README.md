# рдПрдЖрд░рдЖрдИрдПрдордП рдХреЗ рд╕рд╛рде рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА

рдкрд┐рдЫрд▓реЗ рдкрд╛рда рдореЗрдВ, рдЖрдкрдиреЗ рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдереЛрдбрд╝рд╛ рд╕реАрдЦрд╛ рдФрд░ рдПрдХ рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬреЛ рдПрдХ рд╕рдордп рдЕрд╡рдзрд┐ рдореЗрдВ рд╡рд┐рджреНрдпреБрдд рднрд╛рд░ рдХреЗ рдЙрддрд╛рд░-рдЪрдврд╝рд╛рд╡ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред

[![рдПрдЖрд░рдЖрдИрдПрдордП рдХрд╛ рдкрд░рд┐рдЪрдп](https://img.youtube.com/vi/IUSk-YDau10/0.jpg)](https://youtu.be/IUSk-YDau10 "Introduction to ARIMA")

> ЁЯОе рд╡реАрдбрд┐рдпреЛ рдХреЗ рд▓рд┐рдП рдКрдкрд░ рдХреА рдЫрд╡рд┐ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ: рдПрдЖрд░рдЖрдИрдПрдордП рдореЙрдбрд▓реНрд╕ рдХрд╛ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдкрд░рд┐рдЪрдпред рдЙрджрд╛рд╣рд░рдг R рдореЗрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЕрд╡рдзрд╛рд░рдгрд╛рдПрдБ рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ рд╣реИрдВред

## [рдкреНрд░реА-рд▓реЗрдХреНрдЪрд░ рдХреНрд╡рд┐рдЬрд╝](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/43/)

## рдкрд░рд┐рдЪрдп

рдЗрд╕ рдкрд╛рда рдореЗрдВ, рдЖрдк [рдПрдЖрд░рдЖрдИрдПрдордП: *рдСрдЯреЛ*рд░реЗрдЧреНрд░реЗрд╕рд┐рд╡ *рдЗрдВрдЯреАрдЧреНрд░реЗрдЯреЗрдб *рдореВрд╡рд┐рдВрдЧ *рдПрд╡рд░реЗрдЬ](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average) рдХреЗ рд╕рд╛рде рдореЙрдбрд▓ рдмрдирд╛рдиреЗ рдХрд╛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рддрд░реАрдХрд╛ рдЦреЛрдЬреЗрдВрдЧреЗред рдПрдЖрд░рдЖрдИрдПрдордП рдореЙрдбрд▓ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ [рдЧреИрд░-рд╕реНрдЯреЗрд╢рдирд░рд┐рдЯреА](https://wikipedia.org/wiki/Stationary_process) рджрд┐рдЦрд╛рдиреЗ рд╡рд╛рд▓реЗ рдбреЗрдЯрд╛ рдХреЛ рдлрд┐рдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реЛрддреЗ рд╣реИрдВред

## рд╕рд╛рдорд╛рдиреНрдп рдЕрд╡рдзрд╛рд░рдгрд╛рдПрдБ

рдПрдЖрд░рдЖрдИрдПрдордП рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, рдХреБрдЫ рдЕрд╡рдзрд╛рд░рдгрд╛рдПрдБ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдкрдХреЛ рдЬрд╛рдирдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ:

- ЁЯОУ **рд╕реНрдЯреЗрд╢рдирд░рд┐рдЯреА**ред рд╕рд╛рдВрдЦреНрдпрд┐рдХреАрдп рд╕рдВрджрд░реНрдн рд╕реЗ, рд╕реНрдЯреЗрд╢рдирд░рд┐рдЯреА рдЙрди рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдирдХрд╛ рд╡рд┐рддрд░рдг рд╕рдордп рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рд╣реЛрдиреЗ рдкрд░ рдирд╣реАрдВ рдмрджрд▓рддрд╛ рд╣реИред рдЧреИрд░-рд╕реНрдЯреЗрд╢рдирд░реА рдбреЗрдЯрд╛, рдлрд┐рд░, рд░реБрдЭрд╛рдиреЛрдВ рдХреЗ рдХрд╛рд░рдг рдЙрддрд╛рд░-рдЪрдврд╝рд╛рд╡ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╕реАрдЬрдирд▓рд┐рдЯреА рдбреЗрдЯрд╛ рдореЗрдВ рдЙрддрд╛рд░-рдЪрдврд╝рд╛рд╡ рд▓рд╛ рд╕рдХрддреА рд╣реИ рдФрд░ рдЗрд╕реЗ 'рд╕реАрдЬрдирд▓-рдбрд┐рдлрд░реЗрдВрд╕рд┐рдВрдЧ' рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рд╕рдорд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

- ЁЯОУ **[рдбрд┐рдлрд░реЗрдВрд╕рд┐рдВрдЧ](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average#Differencing)**ред рд╕рд╛рдВрдЦреНрдпрд┐рдХреАрдп рд╕рдВрджрд░реНрдн рд╕реЗ рдлрд┐рд░ рд╕реЗ, рдбрд┐рдлрд░реЗрдВрд╕рд┐рдВрдЧ рдбреЗрдЯрд╛ рдХреЛ рд╕реНрдерд┐рд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЧреИрд░-рд╕реНрдЯреЗрд╢рдирд░реА рдбреЗрдЯрд╛ рдХреЛ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИред "рдбрд┐рдлрд░реЗрдВрд╕рд┐рдВрдЧ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рд╕реНрддрд░ рдореЗрдВ рдмрджрд▓рд╛рд╡ рдХреЛ рд╣рдЯрд╛ рджреЗрддрд╛ рд╣реИ, рд░реБрдЭрд╛рди рдФрд░ рд╕реАрдЬрдирд▓рд┐рдЯреА рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рдорд╛рдзреНрдп рдХреЛ рд╕реНрдерд┐рд░ рдХрд░рддрд╛ рд╣реИред" [рд╢рд┐рдХреНрд╕рд┐рдУрдВрдЧ рдПрдЯ рдЕрд▓ рдХрд╛ рдкреЗрдкрд░](https://arxiv.org/abs/1904.07632)

## рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдПрдЖрд░рдЖрдИрдПрдордП

рдЖрдЗрдП рдПрдЖрд░рдЖрдИрдПрдордП рдХреЗ рднрд╛рдЧреЛрдВ рдХреЛ рд╕рдордЭреЗрдВ рддрд╛рдХрд┐ рдпрд╣ рд╕рдордЭ рд╕рдХреЗрдВ рдХрд┐ рдпрд╣ рд╣рдореЗрдВ рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬ рдореЙрдбрд▓ рдмрдирд╛рдиреЗ рдФрд░ рдЗрд╕рдХреЗ рдЦрд┐рд▓рд╛рдл рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ рдХрд░рдиреЗ рдореЗрдВ рдХреИрд╕реЗ рдорджрдж рдХрд░рддрд╛ рд╣реИред

- **рдПрдЖрд░ - рдСрдЯреЛрд░реЗрдЧреНрд░реЗрд╕рд┐рд╡ рдХреЗ рд▓рд┐рдП**ред рдЬреИрд╕рд╛ рдХрд┐ рдирд╛рдо рд╕реЗ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ, рдСрдЯреЛрд░реЗрдЧреНрд░реЗрд╕рд┐рд╡ рдореЙрдбрд▓ рдЖрдкрдХреЗ рдбреЗрдЯрд╛ рдореЗрдВ рдкрд┐рдЫрд▓реА рдорд╛рдиреЛрдВ рдХреЛ 'рдкреАрдЫреЗ' рджреЗрдЦрдиреЗ рдФрд░ рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдзрд╛рд░рдгрд╛рдПрдБ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рджреЗрдЦрддрд╛ рд╣реИред рдЗрди рдкрд┐рдЫрд▓реА рдорд╛рдиреЛрдВ рдХреЛ 'рд▓реИрдЧреНрд╕' рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдПрдХ рдЙрджрд╛рд╣рд░рдг рдкреЗрдВрд╕рд┐рд▓ рдХреА рдорд╛рд╕рд┐рдХ рдмрд┐рдХреНрд░реА рджрд┐рдЦрд╛рдиреЗ рд╡рд╛рд▓реЗ рдбреЗрдЯрд╛ рдХрд╛ рд╣реЛрдЧрд╛ред рдкреНрд░рддреНрдпреЗрдХ рдорд╣реАрдиреЗ рдХреА рдмрд┐рдХреНрд░реА рдХреБрд▓ рдХреЛ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдПрдХ 'рд╡рд┐рдХрд╕рд┐рдд рд╣реЛ рд░рд╣рд╛ рдЪрд░' рдорд╛рдирд╛ рдЬрд╛рдПрдЧрд╛ред рдпрд╣ рдореЙрдбрд▓ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ "рд░реБрдЪрд┐ рдХрд╛ рд╡рд┐рдХрд╕рд┐рдд рдЪрд░ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рд▓реИрдЧреНрдб (рдпрд╛рдиреА, рдкреВрд░реНрд╡) рдорд╛рдиреЛрдВ рдкрд░ рдкреБрдирд░рд╛рд╡реГрддреНрдд рд╣реЛрддрд╛ рд╣реИред" [рд╡рд┐рдХрд┐рдкреАрдбрд┐рдпрд╛](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average)

- **рдЖрдИ - рдЗрдВрдЯреАрдЧреНрд░реЗрдЯреЗрдб рдХреЗ рд▓рд┐рдП**ред рд╕рдорд╛рди 'рдПрдЖрд░рдПрдордП' рдореЙрдбрд▓ рдХреЗ рд╡рд┐рдкрд░реАрдд, рдПрдЖрд░рдЖрдИрдПрдордП рдореЗрдВ 'рдЖрдИ' рдЗрд╕рдХреЗ *[рдЗрдВрдЯреАрдЧреНрд░реЗрдЯреЗрдб](https://wikipedia.org/wiki/Order_of_integration)* рдкрд╣рд▓реВ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИред рдЧреИрд░-рд╕реНрдЯреЗрд╢рдирд░рд┐рдЯреА рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд░реЗрдВрд╕рд┐рдВрдЧ рдЪрд░рдгреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдкрд░ рдбреЗрдЯрд╛ 'рдЗрдВрдЯреАрдЧреНрд░реЗрдЯреЗрдб' рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред

- **рдПрдордП - рдореВрд╡рд┐рдВрдЧ рдПрд╡рд░реЗрдЬ рдХреЗ рд▓рд┐рдП**ред рдЗрд╕ рдореЙрдбрд▓ рдХреЗ [рдореВрд╡рд┐рдВрдЧ-рдПрд╡рд░реЗрдЬ](https://wikipedia.org/wiki/Moving-average_model) рдкрд╣рд▓реВ рдХрд╛ рддрд╛рддреНрдкрд░реНрдп рдЖрдЙрдЯрдкреБрдЯ рд╡реЗрд░рд┐рдПрдмрд▓ рд╕реЗ рд╣реИ рдЬреЛ рд▓реИрдЧреНрд╕ рдХреЗ рд╡рд░реНрддрдорд╛рди рдФрд░ рдкрд┐рдЫрд▓реЗ рдорд╛рдиреЛрдВ рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░рдХреЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╣реЛрддрд╛ рд╣реИред

рдирд┐рдЪрд▓рд╛ рд░реЗрдЦрд╛: рдПрдЖрд░рдЖрдИрдПрдордП рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рд╢реЗрд╖ рдкреНрд░рдХрд╛рд░ рдХреЗ рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬ рдбреЗрдЯрд╛ рдХреЛ рдпрдерд╛рд╕рдВрднрд╡ рдирд┐рдХрдЯрддрд╛ рд╕реЗ рдлрд┐рдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

## рд╡реНрдпрд╛рдпрд╛рдо - рдПрдХ рдПрдЖрд░рдЖрдИрдПрдордП рдореЙрдбрд▓ рдмрдирд╛рдПрдВ

рдЗрд╕ рдкрд╛рда рдореЗрдВ [_/working_](https://github.com/microsoft/ML-For-Beginners/tree/main/7-TimeSeries/2-ARIMA/working) рдлрд╝реЛрд▓реНрдбрд░ рдЦреЛрд▓реЗрдВ рдФрд░ [_notebook.ipynb_](https://github.com/microsoft/ML-For-Beginners/blob/main/7-TimeSeries/2-ARIMA/working/notebook.ipynb) рдлрд╝рд╛рдЗрд▓ рдЦреЛрдЬреЗрдВред

1. рдиреЛрдЯрдмреБрдХ рдЪрд▓рд╛рдПрдВ рддрд╛рдХрд┐ рдЖрдк `statsmodels` Python рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ рд▓реЛрдб рдХрд░ рд╕рдХреЗрдВ; рдЖрдкрдХреЛ рдПрдЖрд░рдЖрдИрдПрдордП рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред

1. рдЖрд╡рд╢реНрдпрдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд▓реЛрдб рдХрд░реЗрдВ

1. рдЕрдм, рдбреЗрдЯрд╛ рдХреЛ рдкреНрд▓реЙрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдХрдИ рдФрд░ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд▓реЛрдб рдХрд░реЗрдВ:

    ```python
    import os
    import warnings
    import matplotlib.pyplot as plt
    import numpy as np
    import pandas as pd
    import datetime as dt
    import math

    from pandas.plotting import autocorrelation_plot
    from statsmodels.tsa.statespace.sarimax import SARIMAX
    from sklearn.preprocessing import MinMaxScaler
    from common.utils import load_data, mape
    from IPython.display import Image

    %matplotlib inline
    pd.options.display.float_format = '{:,.2f}'.format
    np.set_printoptions(precision=2)
    warnings.filterwarnings("ignore") # specify to ignore warning messages
    ```

1. `/data/energy.csv` рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдбреЗрдЯрд╛ рдХреЛ рдПрдХ рдкрд╛рдВрдбрд╛ рдбреЗрдЯрд╛ рдлреНрд░реЗрдо рдореЗрдВ рд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВ:

    ```python
    energy = load_data('./data')[['load']]
    energy.head(10)
    ```

1. рдЬрдирд╡рд░реА 2012 рд╕реЗ рджрд┐рд╕рдВрдмрд░ 2014 рддрдХ рд╕рднреА рдЙрдкрд▓рдмреНрдз рдКрд░реНрдЬрд╛ рдбреЗрдЯрд╛ рдХреЛ рдкреНрд▓реЙрдЯ рдХрд░реЗрдВред рдХреЛрдИ рдЖрд╢реНрдЪрд░реНрдп рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдХреНрдпреЛрдВрдХрд┐ рд╣рдордиреЗ рдЗрд╕ рдбреЗрдЯрд╛ рдХреЛ рдкрд┐рдЫрд▓реЗ рдкрд╛рда рдореЗрдВ рджреЗрдЦрд╛ рдерд╛:

    ```python
    energy.plot(y='load', subplots=True, figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    рдЕрдм, рдЖрдЗрдП рдПрдХ рдореЙрдбрд▓ рдмрдирд╛рдПрдВ!

### рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рдкрд░реАрдХреНрд╖рдг рдбреЗрдЯрд╛рд╕реЗрдЯ рдмрдирд╛рдПрдВ

рдЕрдм рдЖрдкрдХрд╛ рдбреЗрдЯрд╛ рд▓реЛрдб рд╣реЛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдк рдЗрд╕реЗ рдЯреНрд░реЗрди рдФрд░ рдЯреЗрд╕реНрдЯ рд╕реЗрдЯ рдореЗрдВ рдЕрд▓рдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХреЛ рдЯреНрд░реЗрди рд╕реЗрдЯ рдкрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░реЗрдВрдЧреЗред рд╣рдореЗрд╢рд╛ рдХреА рддрд░рд╣, рдореЙрдбрд▓ рдХреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдЖрдк рдЗрд╕рдХреЗ рд╕рдЯреАрдХрддрд╛ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдкрд░реАрдХреНрд╖рдг рд╕реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд░реЗрдВрдЧреЗред рдЖрдкрдХреЛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдкрд░реАрдХреНрд╖рдг рд╕реЗрдЯ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рд╕рдордп рдХреА рдПрдХ рдмрд╛рдж рдХреА рдЕрд╡рдзрд┐ рдХреЛ рдХрд╡рд░ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рд╣реЛ рд╕рдХреЗ рдХрд┐ рдореЙрдбрд▓ рднрд╡рд┐рд╖реНрдп рдХреА рд╕рдордп рдЕрд╡рдзрд┐ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред

1. 1 рд╕рд┐рддрдВрдмрд░ рд╕реЗ 31 рдЕрдХреНрдЯреВрдмрд░, 2014 рдХреА рджреЛ рдорд╣реАрдиреЗ рдХреА рдЕрд╡рдзрд┐ рдХреЛ рдЯреНрд░реЗрдирд┐рдВрдЧ рд╕реЗрдЯ рдореЗрдВ рдЖрд╡рдВрдЯрд┐рдд рдХрд░реЗрдВред рдкрд░реАрдХреНрд╖рдг рд╕реЗрдЯ рдореЗрдВ 1 рдирд╡рдВрдмрд░ рд╕реЗ 31 рджрд┐рд╕рдВрдмрд░, 2014 рдХреА рджреЛ рдорд╣реАрдиреЗ рдХреА рдЕрд╡рдзрд┐ рд╢рд╛рдорд┐рд▓ рд╣реЛрдЧреА:

    ```python
    train_start_dt = '2014-11-01 00:00:00'
    test_start_dt = '2014-12-30 00:00:00'
    ```

    рдЪреВрдВрдХрд┐ рдпрд╣ рдбреЗрдЯрд╛ рдКрд░реНрдЬрд╛ рдХреА рджреИрдирд┐рдХ рдЦрдкрдд рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдПрдХ рдордЬрдмреВрдд рдореМрд╕рдореА рдкреИрдЯрд░реНрди рд╣реИ, рд▓реЗрдХрд┐рди рдЦрдкрдд рд╣рд╛рд▓ рдХреЗ рджрд┐рдиреЛрдВ рдореЗрдВ рдЦрдкрдд рдХреЗ рд╕рдорд╛рди рд╣реИред

1. рдЕрдВрддрд░ рдХреЛ рджреГрд╢реНрдп рд░реВрдк рдореЗрдВ рджреЗрдЦреЗрдВ:

    ```python
    energy[(energy.index < test_start_dt) & (energy.index >= train_start_dt)][['load']].rename(columns={'load':'train'}) \
        .join(energy[test_start_dt:][['load']].rename(columns={'load':'test'}), how='outer') \
        .plot(y=['train', 'test'], figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рдкрд░реАрдХреНрд╖рдг рдбреЗрдЯрд╛](../../../../translated_images/train-test.8928d14e5b91fc942f0ca9201b2d36c890ea7e98f7619fd94f75de3a4c2bacb9.hi.png)

    рдЗрд╕рд▓рд┐рдП, рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдЫреЛрдЯреЗ рд╕рдордп рд╡рд┐рдВрдбреЛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдкрд░реНрдпрд╛рдкреНрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред

    > рдиреЛрдЯ: рдЪреВрдВрдХрд┐ рд╣рдо рдПрдЖрд░рдЖрдИрдПрдордП рдореЙрдбрд▓ рдХреЛ рдлрд┐рдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рд╡рд╣ рдлрд┐рдЯрд┐рдВрдЧ рдХреЗ рджреМрд░рд╛рди рдЗрди-рд╕реИрдВрдкрд▓ рд╕рддреНрдпрд╛рдкрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рд╣рдо рд╕рддреНрдпрд╛рдкрди рдбреЗрдЯрд╛ рдХреЛ рдЫреЛрдбрд╝ рджреЗрдВрдЧреЗред

### рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рддреИрдпрд╛рд░ рдХрд░реЗрдВ

рдЕрдм, рдЖрдкрдХреЛ рдЕрдкрдиреЗ рдбреЗрдЯрд╛ рдХреЛ рдлрд┐рд▓реНрдЯрд░ рдФрд░ рд╕реНрдХреЗрд▓ рдХрд░рдХреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдЕрдкрдиреЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ рдХреЗрд╡рд▓ рдЖрд╡рд╢реНрдпрдХ рд╕рдордп рдЕрд╡рдзрд┐ рдФрд░ рдХреЙрд▓рдо рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд┐рд▓реНрдЯрд░ рдХрд░реЗрдВ, рдФрд░ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдХреЗрд▓рд┐рдВрдЧ рдХрд░реЗрдВ рдХрд┐ рдбреЗрдЯрд╛ рдХреЛ 0,1 рдХреЗ рдЕрдВрддрд░рд╛рд▓ рдореЗрдВ рдкреНрд░рдХреНрд╖реЗрдкрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

1. рдореВрд▓ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ рдХреЗрд╡рд▓ рдЙрдкрд░реЛрдХреНрдд рд╕рдордп рдЕрд╡рдзрд┐ рдкреНрд░рддрд┐ рд╕реЗрдЯ рдФрд░ рдХреЗрд╡рд▓ рдЖрд╡рд╢реНрдпрдХ рдХреЙрд▓рдо 'рд▓реЛрдб' рдФрд░ рддрд╛рд░реАрдЦ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд┐рд▓реНрдЯрд░ рдХрд░реЗрдВ:

    ```python
    train = energy.copy()[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']]
    test = energy.copy()[energy.index >= test_start_dt][['load']]

    print('Training data shape: ', train.shape)
    print('Test data shape: ', test.shape)
    ```

    рдЖрдк рдбреЗрдЯрд╛ рдХрд╛ рдЖрдХрд╛рд░ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:

    ```output
    Training data shape:  (1416, 1)
    Test data shape:  (48, 1)
    ```

1. рдбреЗрдЯрд╛ рдХреЛ (0, 1) рдХреЗ рд░реЗрдВрдЬ рдореЗрдВ рд╕реНрдХреЗрд▓ рдХрд░реЗрдВред

    ```python
    scaler = MinMaxScaler()
    train['load'] = scaler.fit_transform(train)
    train.head(10)
    ```

1. рдореВрд▓ рдмрдирд╛рдо рд╕реНрдХреЗрд▓ рдбреЗрдЯрд╛ рдХреЛ рджреГрд╢реНрдп рд░реВрдк рдореЗрдВ рджреЗрдЦреЗрдВ:

    ```python
    energy[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']].rename(columns={'load':'original load'}).plot.hist(bins=100, fontsize=12)
    train.rename(columns={'load':'scaled load'}).plot.hist(bins=100, fontsize=12)
    plt.show()
    ```

    ![рдореВрд▓](../../../../translated_images/original.b2b15efe0ce92b8745918f071dceec2231661bf49c8db6918e3ff4b3b0b183c2.hi.png)

    > рдореВрд▓ рдбреЗрдЯрд╛

    ![рд╕реНрдХреЗрд▓ рдХрд┐рдпрд╛ рд╣реБрдЖ](../../../../translated_images/scaled.e35258ca5cd3d43f86d5175e584ba96b38d51501f234abf52e11f4fe2631e45f.hi.png)

    > рд╕реНрдХреЗрд▓ рдХрд┐рдпрд╛ рд╣реБрдЖ рдбреЗрдЯрд╛

1. рдЕрдм рдЬрдм рдЖрдкрдиреЗ рд╕реНрдХреЗрд▓ рдХрд┐рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЛ рдХреИрд▓рд┐рдмреНрд░реЗрдЯ рдХрд░ рд▓рд┐рдпрд╛ рд╣реИ, рддреЛ рдЖрдк рдкрд░реАрдХреНрд╖рдг рдбреЗрдЯрд╛ рдХреЛ рд╕реНрдХреЗрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

    ```python
    test['load'] = scaler.transform(test)
    test.head()
    ```

### рдПрдЖрд░рдЖрдИрдПрдордП рд▓рд╛рдЧреВ рдХрд░реЗрдВ

рдЕрдм рдПрдЖрд░рдЖрдИрдПрдордП рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рд╣реИ! рдЕрдм рдЖрдк `statsmodels` рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдЬрд┐рд╕реЗ рдЖрдкрдиреЗ рдкрд╣рд▓реЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдпрд╛ рдерд╛ред

рдЕрдм рдЖрдкрдХреЛ рдХрдИ рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдирд╛ рд╣реЛрдЧрд╛

   1. `SARIMAX()` and passing in the model parameters: p, d, and q parameters, and P, D, and Q parameters.
   2. Prepare the model for the training data by calling the fit() function.
   3. Make predictions calling the `forecast()` function and specifying the number of steps (the `horizon`) to forecast.

> ЁЯОУ What are all these parameters for? In an ARIMA model there are 3 parameters that are used to help model the major aspects of a time series: seasonality, trend, and noise. These parameters are:

`p`: the parameter associated with the auto-regressive aspect of the model, which incorporates *past* values.
`d`: the parameter associated with the integrated part of the model, which affects the amount of *differencing* (ЁЯОУ remember differencing ЁЯСЖ?) to apply to a time series.
`q`: the parameter associated with the moving-average part of the model.

> Note: If your data has a seasonal aspect - which this one does - , we use a seasonal ARIMA model (SARIMA). In that case you need to use another set of parameters: `P`, `D`, and `Q` which describe the same associations as `p`, `d`, and `q` рдХреЙрд▓ рдХрд░рдХреЗ рдореЙрдбрд▓ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ, рд▓реЗрдХрд┐рди рдореЙрдбрд▓ рдХреЗ рдореМрд╕рдореА рдШрдЯрдХреЛрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВред

1. рдЕрдкрдиреА рдкрд╕рдВрджреАрджрд╛ рдХреНрд╖рд┐рддрд┐рдЬ рдорд╛рди рд╕реЗрдЯ рдХрд░рдХреЗ рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВред рдЖрдЗрдП 3 рдШрдВрдЯреЗ рдЖрдЬрдорд╛рдПрдВ:

    ```python
    # Specify the number of steps to forecast ahead
    HORIZON = 3
    print('Forecasting horizon:', HORIZON, 'hours')
    ```

    рдПрдЖрд░рдЖрдИрдПрдордП рдореЙрдбрд▓ рдХреЗ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡реЛрддреНрддрдо рдорд╛рдиреЛрдВ рдХрд╛ рдЪрдпрди рдХрд░рдирд╛ рдЪреБрдиреМрддреАрдкреВрд░реНрдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдХреБрдЫ рд╣рдж рддрдХ рд╡реНрдпрдХреНрддрд┐рдкрд░рдХ рдФрд░ рд╕рдордп рд▓реЗрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИред рдЖрдк `auto_arima()` function from the [`pyramid` рд▓рд╛рдЗрдмреНрд░реЗрд░реА](https://alkaline-ml.com/pmdarima/0.9.0/modules/generated/pyramid.arima.auto_arima.html) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ,

1. рдЕрднреА рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдореИрдиреБрдЕрд▓ рдЪрдпрди рдЖрдЬрдорд╛рдПрдВ рддрд╛рдХрд┐ рдПрдХ рдЕрдЪреНрдЫрд╛ рдореЙрдбрд▓ рдорд┐рд▓ рд╕рдХреЗред

    ```python
    order = (4, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    model = SARIMAX(endog=train, order=order, seasonal_order=seasonal_order)
    results = model.fit()

    print(results.summary())
    ```

    рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреА рдПрдХ рддрд╛рд▓рд┐рдХрд╛ рдореБрджреНрд░рд┐рдд рд╣реЛрддреА рд╣реИред

рдЖрдкрдиреЗ рдЕрдкрдирд╛ рдкрд╣рд▓рд╛ рдореЙрдбрд▓ рдмрдирд╛ рд▓рд┐рдпрд╛ рд╣реИ! рдЕрдм рд╣рдореЗрдВ рдЗрд╕реЗ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдЦреЛрдЬрдирд╛ рд╣реЛрдЧрд╛ред

### рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВ

рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рддрдерд╛рдХрдерд┐рдд `рд╡реЙрдХ рдлреЙрд░рд╡рд░реНрдб` рд╕рддреНрдпрд╛рдкрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ, рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬ рдореЙрдбрд▓ рдХреЛ рд╣рд░ рдмрд╛рд░ рдПрдХ рдирдпрд╛ рдбреЗрдЯрд╛ рдЙрдкрд▓рдмреНрдз рд╣реЛрдиреЗ рдкрд░ рдкреБрди: рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдореЙрдбрд▓ рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рд╕рдордп рдЪрд░рдг рдкрд░ рд╕рд░реНрд╡реЛрддреНрддрдо рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реБрдП, рдЯреНрд░реЗрди рдбреЗрдЯрд╛ рд╕реЗрдЯ рдкрд░ рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░реЗрдВред рдлрд┐рд░ рдЕрдЧрд▓реЗ рд╕рдордп рдЪрд░рдг рдкрд░ рдПрдХ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░реЗрдВред рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдЬреНрдЮрд╛рдд рдорд╛рди рдХреЗ рдЦрд┐рд▓рд╛рдл рдореВрд▓реНрдпрд╛рдВрдХрд┐рдд рдХреА рдЬрд╛рддреА рд╣реИред рдлрд┐рд░ рдЯреНрд░реЗрдирд┐рдВрдЧ рд╕реЗрдЯ рдХреЛ рдЬреНрдЮрд╛рдд рдорд╛рди рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рджреЛрд╣рд░рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

> рдиреЛрдЯ: рдЖрдкрдХреЛ рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ рд╡рд┐рдВрдбреЛ рдХреЛ рд╕реНрдерд┐рд░ рд░рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рд╣рд░ рдмрд╛рд░ рдЬрдм рдЖрдк рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ рдореЗрдВ рдПрдХ рдирдпрд╛ рдЕрд╡рд▓реЛрдХрди рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд╕реЗрдЯ рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ рдЕрд╡рд▓реЛрдХрди рдХреЛ рд╣рдЯрд╛ рджреЗрддреЗ рд╣реИрдВред

рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЗрд╕ рдмрд╛рдд рдХрд╛ рдЕрдзрд┐рдХ рдордЬрдмреВрдд рдЕрдиреБрдорд╛рди рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ рдХрд┐ рдореЙрдбрд▓ рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ рдХреИрд╕рд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░реЗрдЧрд╛ред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрд╣ рдЗрддрдиреЗ рд╕рд╛рд░реЗ рдореЙрдбрд▓ рдмрдирд╛рдиреЗ рдХреА рдЧрдгрдирд╛ рд▓рд╛рдЧрдд рдкрд░ рдЖрддрд╛ рд╣реИред рдпрджрд┐ рдбреЗрдЯрд╛ рдЫреЛрдЯрд╛ рд╣реИ рдпрд╛ рдореЙрдбрд▓ рд╕рд░рд▓ рд╣реИ рддреЛ рдпрд╣ рд╕реНрд╡реАрдХрд╛рд░реНрдп рд╣реИ, рд▓реЗрдХрд┐рди рдкреИрдорд╛рдиреЗ рдкрд░ рдПрдХ рд╕рдорд╕реНрдпрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред

рд╡реЙрдХ-рдлреЙрд░рд╡рд░реНрдб рд╡реИрд▓рд┐рдбреЗрд╢рди рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬ рдореЙрдбрд▓ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд╛ рд╕реНрд╡рд░реНрдг рдорд╛рдирдХ рд╣реИ рдФрд░ рдЖрдкрдХреЗ рдЕрдкрдиреЗ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд╢рдВрд╕рд┐рдд рд╣реИред

1. рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдкреНрд░рддреНрдпреЗрдХ HORIZON рдЪрд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ рдкрд░реАрдХреНрд╖рдг рдбреЗрдЯрд╛ рдмрд┐рдВрджреБ рдмрдирд╛рдПрдВред

    ```python
    test_shifted = test.copy()

    for t in range(1, HORIZON+1):
        test_shifted['load+'+str(t)] = test_shifted['load'].shift(-t, freq='H')

    test_shifted = test_shifted.dropna(how='any')
    test_shifted.head(5)
    ```

    |            |          | рд▓реЛрдб | рд▓реЛрдб+1 | рд▓реЛрдб+2 |
    | ---------- | -------- | ---- | ------ | ------ |
    | 2014-12-30 | 00:00:00 | 0.33 | 0.29   | 0.27   |
    | 2014-12-30 | 01:00:00 | 0.29 | 0.27   | 0.27   |
    | 2014-12-30 | 02:00:00 | 0.27 | 0.27   | 0.30   |
    | 2014-12-30 | 03:00:00 | 0.27 | 0.30   | 0.41   |
    | 2014-12-30 | 04:00:00 | 0.30 | 0.41   | 0.57   |

    рдбреЗрдЯрд╛ рдХреЛ рдЙрд╕рдХреЗ рдХреНрд╖рд┐рддрд┐рдЬ рдмрд┐рдВрджреБ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдХреНрд╖реИрддрд┐рдЬ рд░реВрдк рд╕реЗ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

1. рдЗрд╕ рд╕реНрд▓рд╛рдЗрдбрд┐рдВрдЧ рд╡рд┐рдВрдбреЛ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреЗ рдкрд░реАрдХреНрд╖рдг рдбреЗрдЯрд╛ рдкрд░ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ рдХрд░реЗрдВ рдФрд░ рдкрд░реАрдХреНрд╖рдг рдбреЗрдЯрд╛ рдХреА рд▓рдВрдмрд╛рдИ рдХреЗ рдЖрдХрд╛рд░ рдореЗрдВ рдПрдХ рд▓реВрдк рдореЗрдВ рдХрд░реЗрдВ:

    ```python
    %%time
    training_window = 720 # dedicate 30 days (720 hours) for training

    train_ts = train['load']
    test_ts = test_shifted

    history = [x for x in train_ts]
    history = history[(-training_window):]

    predictions = list()

    order = (2, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    for t in range(test_ts.shape[0]):
        model = SARIMAX(endog=history, order=order, seasonal_order=seasonal_order)
        model_fit = model.fit()
        yhat = model_fit.forecast(steps = HORIZON)
        predictions.append(yhat)
        obs = list(test_ts.iloc[t])
        # move the training window
        history.append(obs[0])
        history.pop(0)
        print(test_ts.index[t])
        print(t+1, ': predicted =', yhat, 'expected =', obs)
    ```

    рдЖрдк рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╣реЛрддреЗ рд╣реБрдП рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:

    ```output
    2014-12-30 00:00:00
    1 : predicted = [0.32 0.29 0.28] expected = [0.32945389435989236, 0.2900626678603402, 0.2739480752014323]

    2014-12-30 01:00:00
    2 : predicted = [0.3  0.29 0.3 ] expected = [0.2900626678603402, 0.2739480752014323, 0.26812891674127126]

    2014-12-30 02:00:00
    3 : predicted = [0.27 0.28 0.32] expected = [0.2739480752014323, 0.26812891674127126, 0.3025962399283795]
    ```

1. рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпреЛрдВ рдХреА рддреБрд▓рдирд╛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд▓реЛрдб рд╕реЗ рдХрд░реЗрдВ:

    ```python
    eval_df = pd.DataFrame(predictions, columns=['t+'+str(t) for t in range(1, HORIZON+1)])
    eval_df['timestamp'] = test.index[0:len(test.index)-HORIZON+1]
    eval_df = pd.melt(eval_df, id_vars='timestamp', value_name='prediction', var_name='h')
    eval_df['actual'] = np.array(np.transpose(test_ts)).ravel()
    eval_df[['prediction', 'actual']] = scaler.inverse_transform(eval_df[['prediction', 'actual']])
    eval_df.head()
    ```

    рдЖрдЙрдЯрдкреБрдЯ
    |     |            | рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк | рдПрдЪ   | рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА | рд╡рд╛рд╕реНрддрд╡рд┐рдХ   |
    | --- | ---------- | --------- | --- | ---------- | -------- |
    | 0   | 2014-12-30 | 00:00:00  | t+1 | 3,008.74   | 3,023.00 |
    | 1   | 2014-12-30 | 01:00:00  | t+1 | 2,955.53   | 2,935.00 |
    | 2   | 2014-12-30 | 02:00:00  | t+1 | 2,900.17   | 2,899.00 |
    | 3   | 2014-12-30 | 03:00:00  | t+1 | 2,917.69   | 2,886.00 |
    | 4   | 2014-12-30 | 04:00:00  | t+1 | 2,946.99   | 2,963.00 |


    рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд▓реЛрдб рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдкреНрд░рддрд┐ рдШрдВрдЯреЗ рдбреЗрдЯрд╛ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рджреЗрдЦреЗрдВред рдпрд╣ рдХрд┐рддрдирд╛ рд╕рдЯреАрдХ рд╣реИ?

### рдореЙрдбрд▓ рд╕рдЯреАрдХрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

рд╕рднреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпреЛрдВ рдкрд░ рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХреА рд╕рдЯреАрдХрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдЙрд╕рдХреЗ рдорд╛рдзреНрдп рдкреВрд░реНрдг рдкреНрд░рддрд┐рд╢рдд рддреНрд░реБрдЯрд┐ (MAPE) рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдХреЗ рдХрд░реЗрдВред

> **ЁЯзо рдЧрдгрд┐рдд рджрд┐рдЦрд╛рдУ**
>
> ![MAPE](../../../../translated_images/mape.fd87bbaf4d346846df6af88b26bf6f0926bf9a5027816d5e23e1200866e3e8a4.hi.png)
>
>  [MAPE](https://www.linkedin.com/pulse/what-mape-mad-msd-time-series-allameh-statistics/) рдХреЛ рдЙрдкрд░реЛрдХреНрдд рд╕реВрддреНрд░ рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЕрдиреБрдкрд╛рдд рдХреЗ рд░реВрдк рдореЗрдВ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рд╕рдЯреАрдХрддрд╛ рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╡рд╛рд╕реНрддрд╡рд┐рдХ<sub>t</sub> рдФрд░ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдирд┐рдд<sub>t</sub> рдХреЗ рдмреАрдЪ рдХрд╛ рдЕрдВрддрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ<sub>t</sub> рджреНрд╡рд╛рд░рд╛ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред "рдЗрд╕ рдЧрдгрдирд╛ рдореЗрдВ рдкреВрд░реНрдг рдорд╛рди рдХреЛ рд╕рдордп рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдирд┐рдд рдмрд┐рдВрджреБ рдХреЗ рд▓рд┐рдП рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдлрд┐рдЯ рдХрд┐рдП рдЧрдП рдмрд┐рдВрджреБрдУрдВ n рдХреА рд╕рдВрдЦреНрдпрд╛ рд╕реЗ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред" [рд╡рд┐рдХрд┐рдкреАрдбрд┐рдпрд╛](https://wikipedia.org/wiki/Mean_absolute_percentage_error)

1. рдХреЛрдб рдореЗрдВ рд╕рдореАрдХрд░рдг рд╡реНрдпрдХреНрдд рдХрд░реЗрдВ:

    ```python
    if(HORIZON > 1):
        eval_df['APE'] = (eval_df['prediction'] - eval_df['actual']).abs() / eval_df['actual']
        print(eval_df.groupby('h')['APE'].mean())
    ```

1. рдПрдХ рдЪрд░рдг рдХрд╛ MAPE рдЧрдгрдирд╛ рдХрд░реЗрдВ:

    ```python
    print('One step forecast MAPE: ', (mape(eval_df[eval_df['h'] == 't+1']['prediction'], eval_df[eval_df['h'] == 't+1']['actual']))*100, '%')
    ```

    рдПрдХ рдЪрд░рдг рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди MAPE:  0.5570581332313952 %

1. рдмрд╣реБ-рдЪрд░рдг рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди MAPE рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВ:

    ```python
    print('Multi-step forecast MAPE: ', mape(eval_df['prediction'], eval_df['actual'])*100, '%')
    ```

    ```output
    Multi-step forecast MAPE:  1.1460048657704118 %
    ```

    рдПрдХ рдЕрдЪреНрдЫрд╛ рдХрдо рд╕рдВрдЦреНрдпрд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╣реИ: рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ рдХрд┐ 10 рдХрд╛ MAPE рд╡рд╛рд▓рд╛ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди 10% рд╕реЗ рдмрдВрдж рд╣реИред

1. рд▓реЗрдХрд┐рди рд╣рдореЗрд╢рд╛ рдХреА рддрд░рд╣, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рд╕рдЯреАрдХрддрд╛ рдорд╛рдк рдХреЛ рджреГрд╢реНрдп рд░реВрдк рд╕реЗ рджреЗрдЦрдирд╛ рдЖрд╕рд╛рди рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдЗрдП рдЗрд╕реЗ рдкреНрд▓реЙрдЯ рдХрд░реЗрдВ:

    ```python
     if(HORIZON == 1):
        ## Plotting single step forecast
        eval_df.plot(x='timestamp', y=['actual', 'prediction'], style=['r', 'b'], figsize=(15, 8))

    else:
        ## Plotting multi step forecast
        plot_df = eval_df[(eval_df.h=='t+1')][['timestamp', 'actual']]
        for t in range(1, HORIZON+1):
            plot_df['t+'+str(t)] = eval_df[(eval_df.h=='t+'+str(t))]['prediction'].values

        fig = plt.figure(figsize=(15, 8))
        ax = plt.plot(plot_df['timestamp'], plot_df['actual'], color='red', linewidth=4.0)
        ax = fig.add_subplot(111)
        for t in range(1, HORIZON+1):
            x = plot_df['timestamp'][(t-1):]
            y = plot_df['t+'+str(t)][0:len(x)]
            ax.plot(x, y, color='blue', linewidth=4*math.pow(.9,t), alpha=math.pow(0.8,t))

        ax.legend(loc='best')

    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![рдПрдХ рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬ рдореЙрдбрд▓](../../../../translated_images/accuracy.2c47fe1bf15f44b3656651c84d5e2ba9b37cd929cd2aa8ab6cc3073f50570f4e.hi.png)

ЁЯПЖ рдПрдХ рдмрд╣реБрдд рд╣реА рдЕрдЪреНрдЫрд╛ рдкреНрд▓реЙрдЯ, рдЬреЛ рдПрдХ рдЕрдЪреНрдЫреЗ рд╕рдЯреАрдХрддрд╛ рд╡рд╛рд▓реЗ рдореЙрдбрд▓ рдХреЛ рджрд┐рдЦрд╛ рд░рд╣рд╛ рд╣реИред рдмрд╣реБрдд рдмрдврд╝рд┐рдпрд╛!

---

## ЁЯЪАрдЪреБрдиреМрддреА

рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬ рдореЙрдбрд▓ рдХреА рд╕рдЯреАрдХрддрд╛ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЛрдВ рдореЗрдВ рдЧрд╣рд░рд╛рдИ рд╕реЗ рдЬрд╛рдПрдВред рд╣рдо рдЗрд╕ рдкрд╛рда рдореЗрдВ MAPE рдХреЛ рдЫреВрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдХреНрдпрд╛ рдЕрдиреНрдп рд╡рд┐рдзрд┐рдпрд╛рдБ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ? рдЙрдирдХрд╛ рд╢реЛрдз рдХрд░реЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдПрдиреЛрдЯреЗрдЯ рдХрд░реЗрдВред рдПрдХ рд╕рд╣рд╛рдпрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ [рдпрд╣рд╛рдВ](https://otexts.com/fpp2/accuracy.html) рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ

## [рдкреЛрд╕реНрдЯ-рд▓реЗрдХреНрдЪрд░ рдХреНрд╡рд┐рдЬрд╝](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/44/)

## рд╕рдореАрдХреНрд╖рд╛ рдФрд░ рд╕реНрд╡-рдЕрдзреНрдпрдпрди

рдпрд╣ рдкрд╛рда рдПрдЖрд░рдЖрдИрдПрдордП рдХреЗ рд╕рд╛рде рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреА рдХреЗрд╡рд▓ рдореВрд▓ рдмрд╛рддреЗрдВ рдЫреВрддрд╛ рд╣реИред [рдЗрд╕ рднрдВрдбрд╛рд░](https://microsoft.github.io/forecasting/) рдФрд░ рдЗрд╕рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдореЙрдбрд▓ рдкреНрд░рдХрд╛рд░реЛрдВ рдореЗрдВ рдЧрд╣рд░рд╛рдИ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рд▓реЗрдХрд░ рдЕрдиреНрдп рддрд░реАрдХреЛрдВ рд╕реЗ рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬ рдореЙрдбрд▓ рдмрдирд╛рдиреЗ рдХреЗ рддрд░реАрдХреЛрдВ рдХреЛ рд╕реАрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдирд╛ рдЬреНрдЮрд╛рди рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордп рдирд┐рдХрд╛рд▓реЗрдВред

## рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ

[рдПрдХ рдирдпрд╛ рдПрдЖрд░рдЖрдИрдПрдордП рдореЙрдбрд▓](assignment.md)

**рдЕрд╕реНрд╡реАрдХрд░рдг**:
рдпрд╣ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдорд╢реАрди-рдЖрдзрд╛рд░рд┐рдд рдПрдЖрдИ рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд╡рд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЬрдмрдХрд┐ рд╣рдо рд╕рдЯреАрдХрддрд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ, рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рджреЛрдВ рдореЗрдВ рддреНрд░реБрдЯрд┐рдпрд╛рдБ рдпрд╛ рдЧрд▓рддрд┐рдпрд╛рдБ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдЗрд╕рдХреА рдореВрд▓ рднрд╛рд╖рд╛ рдореЗрдВ рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╕реНрд░реЛрдд рдорд╛рдирд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, рдкреЗрд╢реЗрд╡рд░ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред рдЗрд╕ рдЕрдиреБрд╡рд╛рдж рдХреЗ рдЙрдкрдпреЛрдЧ рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рд╕реА рднреА рдЧрд▓рддрдлрд╣рдореА рдпрд╛ рдЧрд▓рдд рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЗ рд▓рд┐рдП рд╣рдо рдЙрддреНрддрд░рджрд╛рдпреА рдирд╣реАрдВ рд╣реИрдВред